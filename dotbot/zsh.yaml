- git:
    ~/.oh-my-zsh:
      url: https://github.com/ohmyzsh/ohmyzsh
      name: ohmyzsh/ohmyzsh
      method: clone

    ~/.oh-my-zsh/custom/plugins/fast-syntax-highlighting:
      url: https://github.com/zdharma-continuum/fast-syntax-highlighting
      name: zdharma-continuum/fast-syntax-highlighting

    ~/.oh-my-zsh/custom/plugins/zsh-z:
      url: https://github.com/agkozak/zsh-z
      name: agkozak/zsh-z

- install:
    name: zsh-autosuggestions
    url: https://github.com/zsh-users/zsh-autosuggestions/tags
    version: "/tags/v([\\d.]+)\\.tar\\.gz"
    then:
      git:
        ~/.oh-my-zsh/custom/plugins/zsh-autosuggestions:
          url: https://github.com/zsh-users/zsh-autosuggestions
          name: zsh-users/zsh-autosuggestions

- install:
    name: powerlevel10k
    url: https://github.com/romkatv/powerlevel10k
    then:
      git:
        ~/.oh-my-zsh/custom/themes/powerlevel10k:
          url: https://github.com/romkatv/powerlevel10k
          name: romkatv/powerlevel10k

- link:
    ~/.zshrc:
      source: zsh/zshrc
      safe_force: true
    ~/.config/zsh/common.zsh:
      source: zsh/common.zsh
    ~/.config/p10k/rainbow.zsh:
      source: p10k/rainbow.zsh
    ~/.config/p10k/robbyrussell.zsh:
      source: p10k/robbyrussell.zsh

- package: zsh

- if:
    condition:
      - '{{ OnPath "chsh" }}'
      - '{{ Which "zsh" | ne DefaultShell }}'
    then:
      shell:
        desc: "Making zsh the default shell"
        command: chsh -s {{ Which "zsh" }} ${SUDO_USER:-$USER}
        try_sudo: true
